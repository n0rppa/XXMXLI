<!DOCTYPE html>
<html lang="en">
<!-- Head ja style osat pysyvät samana -->

<body>
    <!-- Navigaatio pysyy samana -->

    <div class="music-player">
        <div id="player-container">
            <audio id="audio-player" controls>
                <source src="assets/audio/track1.mp3" type="audio/mpeg">
                <source src="assets/audio/track1.flac" type="audio/flac">
                Your browser does not support the audio element.
            </audio>
            <div class="controls">
                <button id="prev-button">Previous</button>
                <button id="play-button">Play</button>
                <button id="next-button">Next</button>
            </div>
            <div id="track-info">
                <span id="current-track">Track 1</span>
            </div>
        </div>
    </div>

    <script>
        const playlist = [
            {
                name: 'Track 1',
                sources: [
                    { src: 'assets/audio/track1.mp3', type: 'audio/mpeg' },
                    { src: 'assets/audio/track1.flac', type: 'audio/flac' }
                ]
            },
            {
                name: 'Track 2',
                sources: [
                    { src: 'assets/audio/track2.mp3', type: 'audio/mpeg' },
                    { src: 'assets/audio/track2.flac', type: 'audio/flac' }
                ]
            }
        ];

        let currentTrackIndex = 0;
        const audioPlayer = document.getElementById('audio-player');
        const playButton = document.getElementById('play-button');
        const prevButton = document.getElementById('prev-button');
        const nextButton = document.getElementById('next-button');
        const currentTrackSpan = document.getElementById('current-track');

        function updateAudioSources(track) {
            // Poista vanhat source elementit
            while (audioPlayer.firstChild) {
                audioPlayer.removeChild(audioPlayer.firstChild);
            }
            
            // Lisää uudet source elementit
            track.sources.forEach(source => {
                const sourceElement = document.createElement('source');
                sourceElement.src = source.src;
                sourceElement.type = source.type;
                audioPlayer.appendChild(sourceElement);
            });
        }

        function loadTrack(index) {
            if (index >= 0 && index < playlist.length) {
                currentTrackIndex = index;
                const track = playlist[index];
                
                // Pysäytä nykyinen toisto
                audioPlayer.pause();
                
                // Päivitä lähteet
                updateAudioSources(track);
                
                // Lataa uusi audio
                audioPlayer.load();
                
                // Päivitä kappaleen nimi
                currentTrackSpan.textContent = track.name;
            }
        }

        playButton.addEventListener('click', () => {
            if (audioPlayer.paused) {
                audioPlayer.play().catch(error => {
                    console.error('Playback failed:', error);
                });
            } else {
                audioPlayer.pause();
            }
        });

        prevButton.addEventListener('click', () => {
            if (currentTrackIndex > 0) {
                loadTrack(currentTrackIndex - 1);
            }
        });

        nextButton.addEventListener('click', () => {
            if (currentTrackIndex < playlist.length - 1) {
                loadTrack(currentTrackIndex + 1);
            }
        });

        audioPlayer.addEventListener('play', () => {
            playButton.textContent = 'Pause';
        });

        audioPlayer.addEventListener('pause', () => {
            playButton.textContent = 'Play';
        });

        audioPlayer.addEventListener('error', (e) => {
            console.error('Audio player error:', e);
            currentTrackSpan.textContent = 'Error loading track';
        });

        // Lataa ensimmäinen kappale
        loadTrack(0);
    </script>
</body>
</html>